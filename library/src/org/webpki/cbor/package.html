<body>
<h2>Basic CBOR support</h2>
This package contains java support for CBOR (RFC 8949).
It is mainly intended for low-level security constructs
like COSE and FIDO/CTAP2.
<h3>Currently Supported Primitives</h3>
<table>
<tr><th>CBOR Data Type</th><th>&nbsp;&nbsp;</th><th>Java Counterpart</th></tr>
<tr><td><code>unsigned integer</code></td><td></td><td><code>long</code></td></tr>
<tr><td><code>negative integer</code></td><td></td><td><code>long</code></td></tr>
<tr><td><code>byte string</code></td><td></td><td><code>byte[]</code></td></tr>
<tr><td><code>text string</code></td><td></td><td><code>String</code></td></tr>
<tr><td><code>unsigned bignum</code></td><td></td><td><code>BigInteger</code></td></tr>
<tr><td><code>negative bignum</code></td><td></td><td><code>BigInteger</code></td></tr>
<tr><td><code>date-time</code></td><td></td><td><code>GregorianCalendar</code></td></tr>
<tr><td><code>true</code></td><td></td><td><code>boolean</code></td></tr>
<tr><td><code>false</code></td><td></td><td><code>boolean</code></td></tr>
<tr><td><code>null</code></td><td></td><td><code>null</code></td></tr>
</table>
&nbsp;<br>
CBOR maps are limited to either use <code>integer</code>
or <code>text&nbsp;string</code> objects as keys.
<h3>Deterministic Serialization</h3>
Since this package is intended for security related
work, it is (by design) quite picky about serialization
and does not accept:
<ul>
<li>Leading zeros.</li>
<li><code>bignum</code> objects
that due to their value could equally well be provided in the
shorter <code>integer</code> format.</li>
<li>Map objects mixing <code>integer</code> and <code>text string</code> keys.</li>
</ul>
On output (encode) the preferred serialization format is always used.
<h3>Map Sorting</h3>
Maps are <i>automatically sorted</i> according to section 4.2.3 (which
follows RFC 7049) by default, but can (with an option), be set
to adhere to section 4.2.1.  That is, there are no requirements
for map sorting on input (decode), while output (encode) always
uses the currently mandated sorting order.
<h3 id='csf'>Signature Support</h3>
The CBOR library also contains support for creating and validating
signatures using a specific scheme tentatively called
&quot;CBOR Signature Format&quot; (CSF). 
<p>
Note that unlike COSE (RFC 8152), CSF
leverages <i>deterministic serialization</i>,
enabling constructs like the following:
</p>
<pre>
{
   1: {
     1: "Space Shop",
     2: "100.00",
     3: "EUR"
   },
   2: "spaceshop.com",
   3: "FR7630002111110020050014382",
   4: "https://europeanpaymentsinitiative.eu/fwp",
   5: "62932",
   6: 0("2021-05-03T09:50:08Z"),
   <span style='color:grey'>// signature object</span>
   7: {
     <span style='color:grey'>// alg = ES256</span>
     1: -7,
     <span style='color:grey'>// public key descriptor</span>
     2: {
       <span style='color:grey'>// kty = EC</span>
       1: 2,
       <span style='color:grey'>// crv = P-256</span>
       -1: 1,
       <span style='color:grey'>// x</span>
       -2: h'e812b1a6dcbc708f9ec43cc2921fa0a14e9d5eadcc6dc63471dd4b680c6236b5',
       <span style='color:grey'>// y</span>
       -3: h'9826dcbd4ce6e388f72edd9be413f2425a10f75b5fd83d95fa0cde53159a51d8'
     },
     <span style='color:grey'>// signature value</span>
     5: h'71994b13d48eeb8e9a5cd2801e11af93af92bb1acfcbd92ef0a4f1bb317faf94ae61e
80443763cf212b9fd28f3c91c92ade64558b4382623320f58dfd785606e'
   }
}
</pre>
<i>Explanation: </i>
Labels 1-6 represent the application data while the <i>application-specific</i>
label 7 holds an associated <i>enveloped</i> signature.  A CBOR signature must
(for compatibility with CSF),
be provided as a CBOR <code>map</code> having a fixed set of labels 
according to the following table:
<table>
<tr><th>Label</th><th>&nbsp;&nbsp;</th><th>Function</th></tr>
<tr><td>1</td><td></td><td>Algorithm</td></tr>
<tr><td>2</td><td></td><td>Public key (<i>optional</i>)</td></tr>
<tr><td>3</td><td></td><td>Key Id (<i>optional</i>)</td></tr>
<tr><td>4</td><td></td><td>Certificate path (<i>optional</i>)</td></tr>
<tr><td>5</td><td></td><td>Signature value</td></tr>
</table>
&nbsp;<br>
CSF signatures are validated by running the signature validation 
algorithm over the complete CBOR binary representation, with the signature label (5) and
its associated value as the sole exception. Note that the length
of the <code>map</code> object holding the signature value must
be updated (to reflect the removal of an element) during validation.
</body>
